

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>Absorbing Least Squares &#8212; linearmodels 4.13 documentation</title>
    <link rel="stylesheet" href="../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Basic Examples" href="examples/basic-examples.html" />
    <link rel="prev" title="Introduction" href="introduction.html" />
  
  
   

  <link rel="stylesheet" href="../_static/css/overrides.css" type="text/css" />

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="examples/basic-examples.html" title="Basic Examples"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="Introduction"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">linearmodels 4.13 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Instrumental Variable Estimation</a> &#187;</li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar"><a href="
    ../index.html" class="text-logo">linearmodels 4.13</a>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Instrumental Variable Estimation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Absorbing Least Squares</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/basic-examples.html">Basic Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/advanced-examples.html">Further Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/using-formulas.html">Using formulas to specify models</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/absorbing-regression.html">Absorbing Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference.html">Module Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="mathematical-formula.html">Formulas and Mathematical Detail</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../panel/index.html">Panel Data Model Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../asset-pricing/index.html">Linear Factor Models for Asset Pricing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../system/index.html">System Regression Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utility.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plan.html">Module Plans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changes.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

    
  </div>
</div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../index.html">Docs</a></li>
              
                <li><a href="index.html">Instrumental Variable Estimation</a></li>
              
              <li>Absorbing Least Squares</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <div class="section" id="absorbing-least-squares">
<h1>Absorbing Least Squares<a class="headerlink" href="#absorbing-least-squares" title="Permalink to this headline">¶</a></h1>
<p>OLS and WLS with high-dimensional effects.</p>
<span class="target" id="module-linearmodels.iv.absorbing"><span id="absorbing-module-reference-models"></span></span><div class="section" id="absorbing-ols">
<h2>Absorbing OLS<a class="headerlink" href="#absorbing-ols" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="linearmodels.iv.absorbing.AbsorbingLS">
<em class="property">class </em><code class="sig-name descname">AbsorbingLS</code><span class="sig-paren">(</span><em class="sig-param">dependent</em>, <em class="sig-param">exog=None</em>, <em class="sig-param">*</em>, <em class="sig-param">absorb=None</em>, <em class="sig-param">interactions=None</em>, <em class="sig-param">weights=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/linearmodels/iv/absorbing.html#AbsorbingLS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#linearmodels.iv.absorbing.AbsorbingLS" title="Permalink to this definition">¶</a></dt>
<dd><p>Linear regression with high-dimensional effects</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dependent</strong> (<em>ArrayLike</em>) – Endogenous variables (nobs by 1)</p></li>
<li><p><strong>exog</strong> (<em>ArrayLike</em><em>, </em><em>optional</em>) – Exogenous regressors  (nobs by nexog)</p></li>
<li><p><strong>absorb</strong> (<em>{DataFrame</em><em>, </em><em>Interaction}</em>) – The effects or continuous variables to absorb. When using a DataFrame,
effects must be categorical variables. Other variable types are treated
as continuous variables that should be absorbed. When using an
Interaction, variables in the <cite>cat</cite> argument are treated as effects
and variables in the <cite>cont</cite> argument are treated as continuous.</p></li>
<li><p><strong>interactions</strong> (<em>{DataFrame</em><em>, </em><a class="reference internal" href="#linearmodels.iv.absorbing.Interaction" title="linearmodels.iv.absorbing.Interaction"><em>Interaction</em></a><em>, </em><em>List</em><em>[</em><em>DataFrame</em><em>, </em><a class="reference internal" href="#linearmodels.iv.absorbing.Interaction" title="linearmodels.iv.absorbing.Interaction"><em>Interaction</em></a><em>]</em><em>}</em><em>, </em><em>optional</em>) – Interactions containing both categorical and continuous variables.  Each
interaction is constructed using the Cartesian product of the categorical
variables to produce the dummy, which are then separately interacted with
each continuous variable.</p></li>
<li><p><strong>weights</strong> (<em>ArrayLike</em><em>, </em><em>optional</em>) – Observation weights used in estimation</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Capable of estimating models with millions of effects.</p>
<p>Estimates models of the form</p>
<div class="math notranslate nohighlight">
\[y_i = x_i \beta + z_i \gamma + \epsilon_i\]</div>
<p>where <span class="math notranslate nohighlight">\(\beta\)</span> are parameters of interest and <span class="math notranslate nohighlight">\(\gamma\)</span>
are not. z may be high-dimensional, although must have fewer
variables than the number of observations in y.</p>
<p>The syntax simplifies specifying high-dimensional z when z consists
of categorical (factor) variables, also known as effects, or when
z contains interactions between continuous variables and categorical
variables, also known as fixed slopes.</p>
<p>The high-dimensional effects are fit using LSMR which avoids inverting
or even constructing the inner product of the regressors. This is
combined with Frish-Waugh-Lovell to orthogonalize x and y from z.</p>
<p>z can contain factors that are perfectly linearly dependent. LSMR
estimates a particular restricted set of parameters that captures the
effect of non-redundant components in z.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#linearmodels.iv.absorbing.Interaction" title="linearmodels.iv.absorbing.Interaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Interaction</span></code></a>, <a class="reference internal" href="methods.html#linearmodels.iv.model.IVLIML" title="linearmodels.iv.model.IVLIML"><code class="xref py py-class docutils literal notranslate"><span class="pre">linearmodels.iv.model.IVLIML</span></code></a>, <a class="reference internal" href="methods.html#linearmodels.iv.model.IV2SLS" title="linearmodels.iv.model.IV2SLS"><code class="xref py py-class docutils literal notranslate"><span class="pre">linearmodels.iv.model.IV2SLS</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.sparse.linalg.lsmr</span></code></p>
</div>
<p class="rubric">Examples</p>
<p>Estimate a model by absorbing 2 categoricals and 2 continuous variables</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">lineamodels.iv</span> <span class="k">import</span> <span class="n">AbsorbingLS</span><span class="p">,</span> <span class="n">Interaction</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">((</span><span class="mi">20000</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exog</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">((</span><span class="mi">20000</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">i</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20000</span><span class="p">))</span>
<span class="gp">... </span>                     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cont</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">20000</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">absorb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">cats</span><span class="p">,</span> <span class="n">cont</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="n">AbsorbingLS</span><span class="p">(</span><span class="n">dep</span><span class="p">,</span> <span class="n">exog</span><span class="p">,</span> <span class="n">absorb</span><span class="o">=</span><span class="n">absorb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
<p>Add interactions between the cartesian product of the categorical and
each continuous variables</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">iaction</span> <span class="o">=</span> <span class="n">Interaction</span><span class="p">(</span><span class="n">cat</span><span class="o">=</span><span class="n">cats</span><span class="p">,</span> <span class="n">cont</span><span class="o">=</span><span class="n">cont</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">absorb</span> <span class="o">=</span> <span class="n">Interaction</span><span class="p">(</span><span class="n">cat</span><span class="o">=</span><span class="n">cats</span><span class="p">)</span> <span class="c1"># Other encoding of categoricals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="n">AbsorbingLS</span><span class="p">(</span><span class="n">dep</span><span class="p">,</span> <span class="n">exog</span><span class="p">,</span> <span class="n">absorb</span><span class="o">=</span><span class="n">absorb</span><span class="p">,</span> <span class="n">interactions</span><span class="o">=</span><span class="n">iaction</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="linearmodels.iv.absorbing.AbsorbingLS.absorbed_dependent">
<em class="property">property </em><code class="sig-name descname">absorbed_dependent</code><a class="headerlink" href="#linearmodels.iv.absorbing.AbsorbingLS.absorbed_dependent" title="Permalink to this definition">¶</a></dt>
<dd><p>Dependent variable with effects absorbed</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>dependent</strong> – Dependent after effects have been absorbed</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>DataFrame</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.7)"><strong>RuntimeError</strong></a> – If called before <cite>fit</cite> has been used once</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="linearmodels.iv.absorbing.AbsorbingLS.absorbed_exog">
<em class="property">property </em><code class="sig-name descname">absorbed_exog</code><a class="headerlink" href="#linearmodels.iv.absorbing.AbsorbingLS.absorbed_exog" title="Permalink to this definition">¶</a></dt>
<dd><p>Exogenous variables with effects absorbed</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>exogenous</strong> – Exogenous after effects have been absorbed</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>DataFrame</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.7)"><strong>RuntimeError</strong></a> – If called before <cite>fit</cite> has been used once</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="linearmodels.iv.absorbing.AbsorbingLS.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">cov_type='robust'</em>, <em class="sig-param">debiased=False</em>, <em class="sig-param">lsmr_options=None</em>, <em class="sig-param">use_cache=True</em>, <em class="sig-param">**cov_config</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/linearmodels/iv/absorbing.html#AbsorbingLS.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#linearmodels.iv.absorbing.AbsorbingLS.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate model parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cov_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><em>optional</em>) – <p>Name of covariance estimator to use. Supported covariance
estimators are:</p>
<ul>
<li><p>’unadjusted’, ‘homoskedastic’ - Classic homoskedastic inference</p></li>
<li><p>’robust’, ‘heteroskedastic’ - Heteroskedasticity robust inference</p></li>
<li><p>’kernel’ - Heteroskedasticity and autocorrelation robust
inference</p></li>
<li><p>’cluster’ - One-way cluster dependent inference.
Heteroskedasticity robust</p></li>
</ul>
</p></li>
<li><p><strong>debiased</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – Flag indicating whether to debiased the covariance estimator using
a degree of freedom adjustment.</p></li>
<li><p><strong>**cov_config</strong> – Additional parameters to pass to covariance estimator. The list
of optional parameters differ according to <code class="docutils literal notranslate"><span class="pre">cov_type</span></code>. See
the documentation of the alternative covariance estimators for
the complete list of available commands.</p></li>
<li><p><strong>lsmr_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – Dictionary of options to pass to scipy.sparse.linalg.lsmr</p></li>
<li><p><strong>use_cache</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Flag indicating whether the variables, once purged from the
absorbed variables and interactions, should be stored in the cache,
and retrieved if available. Cache can dramatically speed up
re-fitting large models when the set of absorbed variables and
interactions are identical.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>results</strong> – Results container</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>AbsorbingLSResults</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Additional covariance parameters depend on specific covariance used.
The see the docstring of specific covariance estimator for a list of
supported options. Defaults are used if no covariance configuration
is provided.</p>
<p>If use_cache is True, then variables are hashed based on their
contents using either a 64 bit value (if xxhash is installed) or
a 256 bit value. This allows variables to be reused in different
models if the set of absorbing variables and interactions is held
constant.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="covariance.html#linearmodels.iv.covariance.HomoskedasticCovariance" title="linearmodels.iv.covariance.HomoskedasticCovariance"><code class="xref py py-meth docutils literal notranslate"><span class="pre">linearmodels.iv.covariance.HomoskedasticCovariance()</span></code></a>, <a class="reference internal" href="covariance.html#linearmodels.iv.covariance.HeteroskedasticCovariance" title="linearmodels.iv.covariance.HeteroskedasticCovariance"><code class="xref py py-meth docutils literal notranslate"><span class="pre">linearmodels.iv.covariance.HeteroskedasticCovariance()</span></code></a>, <a class="reference internal" href="covariance.html#linearmodels.iv.covariance.KernelCovariance" title="linearmodels.iv.covariance.KernelCovariance"><code class="xref py py-meth docutils literal notranslate"><span class="pre">linearmodels.iv.covariance.KernelCovariance()</span></code></a>, <a class="reference internal" href="covariance.html#linearmodels.iv.covariance.ClusteredCovariance" title="linearmodels.iv.covariance.ClusteredCovariance"><code class="xref py py-meth docutils literal notranslate"><span class="pre">linearmodels.iv.covariance.ClusteredCovariance()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="linearmodels.iv.absorbing.AbsorbingLS.resids">
<code class="sig-name descname">resids</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/linearmodels/iv/absorbing.html#AbsorbingLS.resids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#linearmodels.iv.absorbing.AbsorbingLS.resids" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute model residuals</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<em>ndarray</em>) – Model parameters (nvar by 1)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>resids</strong> – Model residuals</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="linearmodels.iv.absorbing.AbsorbingLS.wresids">
<code class="sig-name descname">wresids</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/linearmodels/iv/absorbing.html#AbsorbingLS.wresids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#linearmodels.iv.absorbing.AbsorbingLS.wresids" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute weighted model residuals</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<em>ndarray</em>) – Model parameters (nvar by 1)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>wresids</strong> – Weighted model residuals</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses weighted versions of data instead of raw data.  Identical to
resids if all weights are unity.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="interactions">
<h2>Interactions<a class="headerlink" href="#interactions" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="linearmodels.iv.absorbing.Interaction">
<em class="property">class </em><code class="sig-name descname">Interaction</code><span class="sig-paren">(</span><em class="sig-param">cat=None</em>, <em class="sig-param">cont=None</em>, <em class="sig-param">nobs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/linearmodels/iv/absorbing.html#Interaction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#linearmodels.iv.absorbing.Interaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that simplifies specifying interactions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cat</strong> (<em>{ndarray</em><em>, </em><em>Series</em><em>, </em><em>DataFrame</em><em>, </em><em>DataArray}</em><em>, </em><em>optional</em>) – Variables to treat as categoricals. Best format is a Categorical
Series or DataFrame containing Categorical Series. Other formats
are converted to Categorical Series, column-by-column. cats has
shape (nobs, ncat).</p></li>
<li><p><strong>cont</strong> (<em>{ndarray</em><em>, </em><em>Series</em><em>, </em><em>DataFrame</em><em>, </em><em>DataArray}</em><em>, </em><em>optional</em>) – Variables to treat as continuous, (nobs, ncont).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For each variable in <cite>cont</cite>, computes the interaction of the variable
and the cartesian product of the categories.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">linearmodels.iv.absorbing</span> <span class="k">import</span> <span class="n">Interaction</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cats</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># binary dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cont</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interact</span> <span class="o">=</span> <span class="n">Interaction</span><span class="p">(</span><span class="n">cats</span><span class="p">,</span> <span class="n">cont</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interact</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Get the shape of the dummy matrix</span>
<span class="go">(100000, 6)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">rs</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)))</span>
<span class="gp">... </span>                 <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cats</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="go">             0       1       2       3</span>
<span class="go">count   100000  100000  100000  100000</span>
<span class="go">unique       5       5       5       5</span>
<span class="go">top          3       3       0       4</span>
<span class="go">freq     20251   20195   20331   20158</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">interact</span> <span class="o">=</span> <span class="n">Interaction</span><span class="p">(</span><span class="n">cats</span><span class="p">,</span> <span class="n">cont</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interact</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># Cart product of all cats, 5**4, times ncont, 3</span>
<span class="go">(100000, 1875)</span>
</pre></div>
</div>
<dl class="method">
<dt id="linearmodels.iv.absorbing.Interaction.cat">
<em class="property">property </em><code class="sig-name descname">cat</code><a class="headerlink" href="#linearmodels.iv.absorbing.Interaction.cat" title="Permalink to this definition">¶</a></dt>
<dd><p>Categorical Variables</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="linearmodels.iv.absorbing.Interaction.cont">
<em class="property">property </em><code class="sig-name descname">cont</code><a class="headerlink" href="#linearmodels.iv.absorbing.Interaction.cont" title="Permalink to this definition">¶</a></dt>
<dd><p>Continuous Variables</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="linearmodels.iv.absorbing.Interaction.from_frame">
<em class="property">static </em><code class="sig-name descname">from_frame</code><span class="sig-paren">(</span><em class="sig-param">frame</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/linearmodels/iv/absorbing.html#Interaction.from_frame"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#linearmodels.iv.absorbing.Interaction.from_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function the simplifies using a DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frame</strong> (<em>DataFrame</em>) – Frame containing categorical and continuous variables. All
categorical variables are passed to <cite>cat</cite> and all other
variables are passed as <cite>cont</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>interaction</strong> – Instance using the columns of frame</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#linearmodels.iv.absorbing.Interaction" title="linearmodels.iv.absorbing.Interaction">Interaction</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">linearmodels.iv.absorbing</span> <span class="k">import</span> <span class="n">Interaction</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">rs</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)))</span>
<span class="gp">... </span>                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cats</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cat</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cont</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cont</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rs</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="mi">6</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">cats</span><span class="p">,</span> <span class="n">cont</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interact</span> <span class="o">=</span> <span class="n">Interaction</span><span class="o">.</span><span class="n">from_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interact</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># Cart product of all cats, 5!, times ncont, 6</span>
<span class="go">(100000, 720)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="linearmodels.iv.absorbing.Interaction.hash">
<em class="property">property </em><code class="sig-name descname">hash</code><a class="headerlink" href="#linearmodels.iv.absorbing.Interaction.hash" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a hash that will be invariant for any permutation of
inputs that produce the same fit when used as regressors</p>
</dd></dl>

<dl class="method">
<dt id="linearmodels.iv.absorbing.Interaction.sparse">
<em class="property">property </em><code class="sig-name descname">sparse</code><a class="headerlink" href="#linearmodels.iv.absorbing.Interaction.sparse" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a sparse interaction matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>dummy_interact</strong> – Dummy interaction constructed from the cartesian product of
the categories and each of the continuous variables.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>csc_matrix</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The number of columns in <cite>dummy_interact</cite> is</p>
<div class="math notranslate nohighlight">
\[ncont \times \prod_{i=1}^{ncat} |c_i|\]</div>
<p>where <span class="math notranslate nohighlight">\(|c_i|\)</span> is the number distinct categories in column i.</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="introduction.html" title="previous chapter (use the left arrow)">Introduction</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="examples/basic-examples.html" title="next chapter (use the right arrow)">Basic Examples</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="examples/basic-examples.html" title="Basic Examples"
             >next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="Introduction"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">linearmodels 4.13 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Instrumental Variable Estimation</a> &#187;</li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2017, Kevin Sheppard. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>